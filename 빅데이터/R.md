## Rstudio 

- 관리자 모드로 설정하기

![image-20200319095004339](images/image-20200319095004339.png)

![image-20200319095025770](images/image-20200319095025770.png)

- 글자 설정하기
  - 상단 Tools -> global option

![image-20200319100813950](images/image-20200319100813950.png)



- R 실행시키기
  - R은 한줄씩만 실행시킬 수 있다
  - ctrl + enter누르면 한번에 실행됨.

![image-20200319100910422](images/image-20200319100910422.png)

- ctrl + L
  - 콘솔창 지우기

![image-20200319101300682](images/image-20200319101300682.png)

- 실행했던 코드, 변수나 객체에 저장되어있는 값등 확인가능
  - connection은 DBMS나 외부프로그램과 연동할 수 있는 곳

![image-20200319101347406](images/image-20200319101347406.png)

- help가 잘 나와있음

![image-20200319101751640](images/image-20200319101751640.png)



*** ctrl 1 => 스크립트창, ctrl 2 => 콘솔창 ***



## 프로젝트 만들기

- 좌상단 File -> new project 

![image-20200319102006806](images/image-20200319102006806.png)

![image-20200319102017540](images/image-20200319102017540.png)

- 아래대로 Create Project누르면 기존에 작업하던 Rstudio가 교체됨
  - Open in new session누르면 새로운 Rstudio가 생김

![image-20200319102123199](images/image-20200319102123199.png)

- 저장하기
  - 서로다른 스크립트끼리 변수를 공유한다.

![image-20200319102337614](images/image-20200319102337614.png)

![image-20200319102400193](images/image-20200319102400193.png)

- 아래 체크하면 스크립트 창에 코드를 작성할 때 스크립트 창의 크기를 넘어가면 자동으로 줄바꿈이 됨.

![image-20200319102526137](images/image-20200319102526137.png)



- 상단 Tools -> project option
  - 이런것도 있다.

![image-20200319102716372](images/image-20200319102716372.png)



## R사용하기

- 2번처럼 변수를 저장할 꺼임. 1번으로 저장하면 안 먹힐때도 있음.
  - #은 주석문

![image-20200319103133092](images/image-20200319103133092.png)

- 비교연산자

![image-20200319103250388](images/image-20200319103250388.png)

- 코드 전체 범위지정하고 shift + ' 하면 코드전체에 큰 따옴표 쓸 수 있음.
  - 코드 전체 범위지정하기 => shift + Home

- Alt + - 쓰면 변수에 값 저장할때 쓰는 <- 가 생김



- class 함수

![image-20200319104628929](images/image-20200319104628929.png)

- as.character와 as.numeric함수로 형변환

![image-20200319104832293](images/image-20200319104832293.png)

- = 와 <-의 차이점
  - 앞으로 <-를 쓰자

![image-20200319110947315](images/image-20200319110947315.png)

![image-20200319111034761](images/image-20200319111034761.png)

## vector(arraylist느낌)

- c()로 벡터를 만들 수 있음.
  - combine
  - 변수에 여러개의 값을 넣기

![image-20200319111345897](images/image-20200319111345897.png)

- 에러났을 때 빠져나오기
  - 스크립트 17번 라인에서 닫는괄호를 실행안해줘서 에러난것. 
  - 에러에서 빠져나오려면 콘솔창 아무데나 클릭하고 ESC눌러주기

![image-20200319111738671](images/image-20200319111738671.png)

- 덧셈, 뺄셈, 변수끼리 덧셈도 가능

![image-20200319111919448](images/image-20200319111919448.png)

![image-20200319112329215](images/image-20200319112329215.png)

![image-20200319112529829](images/image-20200319112529829.png)

![image-20200319112849782](images/image-20200319112849782.png)

- 나머지 => 짝수만 TRUE

![image-20200319112947566](images/image-20200319112947566.png)

![image-20200319113055360](images/image-20200319113055360.png)

![image-20200319113610433](images/image-20200319113610433.png)

- 벡터의 이름 정해주기
  - 처음엔 이름을 안정해줘서 null나왔다가 c() 이름 정해주니까 이름 출력됨.

![image-20200319113911753](images/image-20200319113911753.png)

![image-20200319114033336](images/image-20200319114033336.png)

- dataframe은 타입이 열마다 다를 수 있다.

![20200320_122231](images/20200320_122231.jpg)

## matrix(행렬인데 저장할 수 있는 데이터타입이 같아야함)

- 그냥 아무것도 없이 출력했을 때 1열임

![image-20200319131326317](images/image-20200319131326317.png)

- 아래처럼 열의 수를 지정해줄 수도 있고 행방향으로 출력하게해줄 수도 있다.
  - ncol, byrow

![image-20200319131753785](images/image-20200319131753785.png) 

![image-20200319132118867](images/image-20200319132118867.png)

![image-20200319132253799](images/image-20200319132253799.png)

![image-20200319132539870](images/image-20200319132539870.png)

- cbind()
  - 아래는 행이 5개인데 cbind에 4개짜리 행만 값을 넣어줘서 경고 먹은거

![image-20200319133131320](images/image-20200319133131320.png)

- rbind()

![image-20200319133325605](images/image-20200319133325605.png)

- comnames, rownames

![image-20200319133551076](images/image-20200319133551076.png)

- 행렬의 평균구하기

![image-20200319133643309](images/image-20200319133643309.png)

- 미니 실습

![image-20200319141748435](images/image-20200319141748435.png)

- 내 풀이

![스크립트](images/스크립트.PNG)

![콘솔](images/콘솔.PNG)

- 선생님 풀이

![image-20200319142629135](images/image-20200319142629135.png)

![image-20200319142708718](images/image-20200319142708718.png)

- byrow는 행렬을 생성할 때 주는 옵션임. 행렬을 만든 후에 값의 위치를 바꾸고 싶을때는??

![image-20200319150946620](images/image-20200319150946620.png)

![image-20200319150959466](images/image-20200319150959466.png)

## list



## dataframe(행렬인데 저장할 수 있는 데이터 타입이 달라도됨)

- matrix를 dataframe으로 변환

![image-20200319143401232](images/image-20200319143401232.png)

![image-20200319143512481](images/image-20200319143512481.png)

- 아래는 dataframeMat1의 1열만 character로 바꾸고 싶어서 코드를 짠건데 모든 값들이 다 character로 바뀌었다.

![image-20200319143623553](images/image-20200319143623553.png)

- str함수써서 dataframe의 1열이 int형에서 char형으로 바뀐것을 볼 수 있음

![image-20200319143916641](images/image-20200319143916641.png)

-  $사용

![image-20200319144049000](images/image-20200319144049000.png)

- dataframe에 열 추가

![image-20200319144147428](images/image-20200319144147428.png)

- dataframe을 matrix로 변환

![image-20200319144251248](images/image-20200319144251248.png)

- 벡터로 dataframe만들기
  - 열로 만들어지네
  - 각 열당 평균도 구할 수 있음

![image-20200319144853869](images/image-20200319144853869.png)

- dataframe을 직접 만들기

![image-20200319145010874](images/image-20200319145010874.png)

## 제어구문(if, while...)

### if(자바랑 똑같음)

![image-20200319153725618](images/image-20200319153725618.png)

![image-20200319153826641](images/image-20200319153826641.png)

### for

- print()를 이용해서 출력

![image-20200319154240738](images/image-20200319154240738.png)

- 합 구하기
  - version 1 => 평소에 하던대로 로직 짜는거
  - version 2 => 함수 이용하기

![image-20200319154958268](images/image-20200319154958268.png)

## csv파일 실행하기

![image-20200319161323847](images/image-20200319161323847.png)

- 조건주기

![image-20200319161740416](images/image-20200319161740416.png)

- csv파일 쓰기

![image-20200319161957181](images/image-20200319161957181.png)

[실습]

csv_exam.csv를 읽어서 데이터를 수정한 후 csv_exam_result.csv로 저장하기

- science가 80이상인 데이터를 추출
- 추출된 데이터에 mytotal과 myavg컬럼을 추가
- mytotal: 모든 과목(math,eng,science)의 총점
- myavg: 모든 과목의 평균

![image-20200319165706386](images/image-20200319165706386.png)

![콘솔](images/콘솔-1584604491429.PNG)

[실습 선생님 풀이]

![image-20200320093548459](images/image-20200320093548459.png)

![image-20200320093600117](images/image-20200320093600117.png)



## 인코딩

- 가져온 데이터가 깨졌을 때 복원하기
- 보통 파일이 깨졌을 때
  - File -> reopen with encoding

![image-20200320101140548](images/image-20200320101140548.png)



- 위에처럼 말고 우리가 직접 변환하기?
  - letters => a~z까지의 모든 값이 들어있음



- ''' #### ~~~~ #### 사용하면 코드를 더 쉽게 읽을 수 있음

![image-20200320102008657](images/image-20200320102008657.png)

![image-20200320102039301](images/image-20200320102039301.png)



- 인코딩하기

![image-20200320102520865](images/image-20200320102520865.png)

- 아래 보면 utf8만 깨져있다.

![image-20200320102641970](images/image-20200320102641970.png)

- 깨진 utf8을 읽으니까 데이터를 읽을 수 없다.

![image-20200320102806883](images/image-20200320102806883.png)

- readLines으로 실행해보면 파일이 깨져서 보임.

![image-20200320103034345](images/image-20200320103034345.png)

- UTF-8을 인코딩해주면 아래처럼 파일 깨진게 복원됨.

![image-20200320103203890](images/image-20200320103203890.png)



### data.table

- data.table패키지 설치 -> 라이브러리에 등록
- 깨진 파일을 fread함수로 읽고 head로 보면 깨져있는것을 확인할 수 있다.
  - fread함수는 data.table라이브러리에서 지원해주는 함수임.

![image-20200320103743015](images/image-20200320103743015.png)

- 아래처럼 인코딩 해주면 한 컬럼을 인코딩해줄 수 있다.

  - dftable$mydata3 을 해줬으니까 한 컬럼만 인코딩된거.

  - head로 읽으면 위에서부터 몇줄을 읽을 수 있다. (tail도 있음)

![image-20200320103848439](images/image-20200320103848439.png)



### ggplot(데이터 시각화)

- 패키지 설치 -> 라이브러리 등록



- 시각화시키기
  - qplot

![image-20200320104449672](images/image-20200320104449672.png)



- mpg는 제공해주는 예제 데이터임

![image-20200320104617778](images/image-20200320104617778.png)

![image-20200320104703550](images/image-20200320104703550.png)

- geom
  - 그래프의 타입

![image-20200320104756350](images/image-20200320104756350.png)

![image-20200320104821533](images/image-20200320104821533.png)

![image-20200320104853796](images/image-20200320104853796.png)



## 외부 데이터 읽어오기

- 데이터가 어떻게 구성되어 있는지를 알아야 분석하기 좋다.

- n=3을 붙여주니까 3줄을 볼 수 있다.

![image-20200320111059563](images/image-20200320111059563.png)

- 위에서 csv파일을 3줄 읽었는데 이거를 아래 사진은 하나의 컬럼에 다 넣었음.
  - 하나의 컬럼에 데이터들이 다 있을 때 여러 컬럼으로 분리하려고 이렇게 만든거임.

![image-20200320112041104](images/image-20200320112041104.png)

- 1번 -> 콤마로 분리 안되고 그대로 출력됨.
- 2번 -> 콤마를 기준으로 분리. 탭으로 분리하는것도 가능

![image-20200320112610235](images/image-20200320112610235.png)

- 근데 콤마로 분리는 되지만 list로 결과가 리턴되어서 불편하다.
  - 아래는 list의 원하는 요소를 뽑아볼 수 있는 방법

![image-20200320112642506](images/image-20200320112642506.png)

- 

![image-20200320113756620](images/image-20200320113756620.png)

- dfcsv2는 data.table이기도 하고 data.frame이기도 하다.
  - 이러면 데이터 작업을 하기가 어려워서 하나로 통일해줘야한다.

![image-20200320114612797](images/image-20200320114612797.png)

*** 크롤링 할때 데이터 정제하고 가공하는게 우선임. ***

*** readLines쓰면 구조파악이 편하다는거지 꼭 쓰라는건 아님 ***

- 데이터 타입 변경하기

![image-20200320131920376](images/image-20200320131920376.png)

- 아래는 각 컬럼들의 타입도 다 확인해보는 것.
  - 문자열은 chr인데 다 factor라고 뜨네.
  - factor 의미

![image-20200320132155948](images/image-20200320132155948.png)

- str함수로 각 컬럼의 타입 확인.

![image-20200320132934340](images/image-20200320132934340.png)

- 타입 변경하기.
  - 컬럼의 갯수를 세주는 함수 => ncol(dfcsv2)

![image-20200320133020882](images/image-20200320133020882.png)

### tsv파일 읽기

- read.delim => stringTokenizer같은 거.
  - head는 위에서 부터 6줄을 읽는게 기본임.

![image-20200320133352882](images/image-20200320133352882.png)

### xml파일 읽기

- 얘는 패키지가 있어야함.
  - xmlTreeParse로 읽음.
  - 아래는 전부 다 읽었을 때

![image-20200320134455937](images/image-20200320134455937.png)

![image-20200320134508095](images/image-20200320134508095.png)

- root 엘리먼트만 읽었을 때 
  - root꺼만 뽑힘. 위 사진의 내용이 빠져있음.

![image-20200320134748089](images/image-20200320134748089.png)

![image-20200320134549735](images/image-20200320134549735.png)

- xml에 있는 모든 태그(<>)의 name과 value를 추출

  - for문을 대신하는 함수는 apply임.

  - 위의 사진을 보면 record태그 안에 id,names...태그들이 하위로 있는 형태임. 
    - depth가 있는거.
  - 사용자 정의로 function만들어줄 수도 있음 
    - function(x)
  - dfxml에있는 데이터가 하나씩 꺼내져서 x로 전달됨. 그리고 x에 있는 데이터가 xmlvalue로 전달됨.

![image-20200320140944382](images/image-20200320140944382.png)

- 보면 결과가 하나씩 뽑아지긴 함.

![image-20200320141004930](images/image-20200320141004930.png)

- 데이터를 뽑은 dfxml을 dataframe으로 변경해줘야함.

![image-20200320141342551](images/image-20200320141342551.png)

![image-20200320141402630](images/image-20200320141402630.png)

### 엑셀파일 읽기(xlsv)

- 라이브러리를 설치해야됨.
  - 리턴 타입이 tibble이라는 또 다른 타입으로 나왔음.
    - tibble => data.frame과 비슷한 다른 종류의 라이브러리임.

![image-20200320141847335](images/image-20200320141847335.png)



## 데이터 분석

1. 데이터 가져오기
   - 외부파일
   - 크롤링
   - DB(오라클, mongodb, hadoop....)

==> 지금까지 R에서 사용할 수 있는 여러 형태의 데이터로 변환하고 변환된 데이터를 액세스 했음.

2. 데이터의 정보를 확인하기(데이터 구조 확인하기),100p
   - 컬럼갯수, row갯수, 타입, 유형, 실제 저장된 데이터....
   - 실습 data_info 스크립트 파일

- head는 위에서부터 6개, tail은 아래서부터 6개, n은 생략가능(n써주면 써준만큼 가져오기)

![image-20200320142551753](images/image-20200320142551753.png)

- 실제 뷰어로 보기

![image-20200320142732706](images/image-20200320142732706.png)

![image-20200320142746752](images/image-20200320142746752.png)

- 행의 갯수 확인하기

![image-20200320142929974](images/image-20200320142929974.png)

- 컬럼의 갯수 확인하기

![image-20200320142958227](images/image-20200320142958227.png)

- 행과 열의 갯수를 확인

![image-20200320143042177](images/image-20200320143042177.png)

- 타입과 구성확인
  - 컬럼 이름인 id,class,math...앞에 $가 붙어 있음.

![image-20200320143121947](images/image-20200320143121947.png)

- 데이터에 대한 요약정보 
  - summary
    - 최대,최소,평균,중간, 1/4

![image-20200320143233161](images/image-20200320143233161.png)

- 컬럼의 이름 변경하기.
  - 라이브러리를 추가해야함.
    - dplyr
  - english컬럼명이 eng로 바뀜.

![image-20200320143833822](images/image-20200320143833822.png)

- sample함수
  - 랜덤값을 만들때 사용하는 함수
    - 아래는 1~10의 랜덤수고 5개마 a에 저장하는것임.
    - 1번 라인을 실행시킬 때 마다 숫자들이 바뀜.

![image-20200320154858587](images/image-20200320154858587.png)

- replace를 TRUE를 하면 중복가능, FALSE로하면 중복 불가능
  - FALSE가 디폴트임

![image-20200320155035722](images/image-20200320155035722.png)

![image-20200320155058294](images/image-20200320155058294.png)

- set.seed(숫자)
  - 숫자는 아무거나 줘도 상관없음, 숫자를 뭘 주느냐에 따라 어떻게 랜덤으로 배치할껀지 정해진게 있나봄
  - 숫자는 랜덤수 발생시켰던게 어떤건지 찾아갈 수 있는 key값임. 한마디로 이거 쓰면 sample함수를 처음 호출했을때의 값이 고정된다는 말.

![image-20200320155541025](images/image-20200320155541025.png)

- 데이터가 많으면 for문과 if문을 써서 아래처럼 값을 비교하기가 비효율적임.  그래서 ifelse함수로 처리하자.

![image-20200320161936644](images/image-20200320161936644.png)

- if문의 역할을 하는 함수.
  - ifelse

![image-20200320162343615](images/image-20200320162343615.png)

- 조건이 두개 이상인 경우
  - 아래의 ifdf는 spring, bigdata, android 세개의 조건이 있음.

![image-20200320162701935](images/image-20200320162701935.png)

- table() , qplot() 

![image-20200320170956343](images/image-20200320170956343.png)